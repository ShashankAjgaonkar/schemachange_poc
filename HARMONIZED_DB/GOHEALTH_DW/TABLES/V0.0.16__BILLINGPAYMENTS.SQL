create TABLE if not exists {{ environment }}_HARMONIZED_DB.GOHEALTH_DW.BILLINGPAYMENTS (
	PARTNERSK NUMBER(38,0),
	PAYMENTID VARCHAR(50) NOT NULL,
	POSTDATESK NUMBER(38,0),
	VISITID NUMBER(38,0),
	VISITSK VARCHAR(16777216),
	PATIENTDOSID VARCHAR(50),
	SERVICEDATESK NUMBER(38,0),
	CENTERSK NUMBER(38,0),
	GUARANTORID NUMBER(38,0),
	GUARANTORSK VARCHAR(16777216),
	PATIENTID VARCHAR(50),
	PATIENTSK VARCHAR(16777216),
	SERVICEPROVIDERID VARCHAR(16777216),
	SERVICEPROVIDERSK VARCHAR(16777216),
	BILLPROVIDERID VARCHAR(50),
	BILLPROVIDERSK VARCHAR(16777216),
	POSTEDBYUSERID VARCHAR(50),
	POSTEDBYUSERSK VARCHAR(16777216),
	VOIDDATESK NUMBER(38,0),
	ISVOIDED NUMBER(38,0),
	ISREVERSED NUMBER(38,0),
	DIMPAYORSK NUMBER(38,0),
	DIMPAYORPLANSK NUMBER(38,0),
	TRANSACTIONCODESK NUMBER(38,0),
	AMOUNT NUMBER(18,2),
	UNDISTRIBUTEDAMT NUMBER(38,2),
	MATCHEDTOCHARGEAMT NUMBER(38,2),
	MATCHEDTOINVOICEAMT NUMBER(38,2),
	MATCHEDTOPAYMENTAMT NUMBER(38,2),
	MATCHEDTOADJUSTMENTAMT NUMBER(38,2),
	ISDENIAL NUMBER(38,0),
	ISZEROPAYMENT NUMBER(38,0),
	PAYMENTSOURCESK NUMBER(38,0),
	BASECREATEDDATE TIMESTAMP_NTZ(9),
	BASEUPDATEDDATE TIMESTAMP_NTZ(9),
	BASEDELETEDFLAG NUMBER(38,0),
	DEPOSITDATESK NUMBER(38,0),
	CHECKNO VARCHAR(16777216),
	BATCHID NUMBER(38,0),
	REVERSALDATESK NUMBER(38,0),
	SNOWFLAKE_UPDATED_AT TIMESTAMP_NTZ(9),
	SNOWFLAKE_CREATED_AT TIMESTAMP_NTZ(9),
	SNOWFLAKE_DELETED_FLAG NUMBER(38,0),
	BILLINGPAYMENTSK VARCHAR(16777216) AS (CONCAT(CAST(PARTNERSK AS VARCHAR(16777216)), PAYMENTID)) NOT NULL,
	primary key (BILLINGPAYMENTSK)
);

ALTER TABLE {{ environment }}_HARMONIZED_DB.GOHEALTH_DW.BILLINGPAYMENTS ADD COLUMN TEST2 VARCHAR;


