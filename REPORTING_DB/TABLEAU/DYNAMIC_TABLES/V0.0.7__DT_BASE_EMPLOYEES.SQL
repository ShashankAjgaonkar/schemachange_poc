create or replace dynamic table {{ environment }}_REPORTING_DB.TABLEAU.DT_BASE_EMPLOYEES(
	EMPLOYEEXREFCODE,
	EMPLOYEENUMBER,
	MANAGEREMPLOYEENUMBER,
	FIRSTNAME,
	LASTNAME,
	MIDDLENAME,
	COMMONNAME,
	BUSINESSEMAIL,
	EMPLOYMENTSTATUS,
	EMPLOYMENTSTATUSGROUP,
	ORIGINALHIREDATE,
	HIREDATE,
	ESTIMATEDRETURNDATE,
	TERMINATIONDATE,
	EMPLOYEEGROUPXREFCODE,
	EMPLOYEEGROUP,
	DEPARTMENTXREFCODE,
	DEPARTMENT,
	LEDGERCODE,
	PRIMARYLOCATIONXREFCODE,
	PRIMARYLOCATION,
	JOBXREFCODE,
	JOBNAME,
	JOBFAMILYXREFCODE,
	JOBFAMILY,
	PAYCLASSXREFCODE,
	PAYCLASS,
	PAYGROUPXREFCODE,
	PAYGROUP,
	PAYTYPEXREFCODE,
	PAYTYPE,
	PAYTYPEGROUPXREFCODE,
	PAYTYPEGROUP,
	NORMALWEEKLYHOURS,
	BASECREATEDDATE,
	BASEUPDATEDDATE,
	BASEDELETEDFLAG,
	EMPLOYMENTSTATUSLASTMODIFIEDDATE,
	FEDERATEDID,
	EMPLOYMENTSTATUSEFFECTIVESTART,
	HOMEPHONE,
	DEPARTMENTLEDGERCODE,
	POSITIONNAME,
	MOBILEPHONE,
	DEPARTMENTID,
	LOCATIONID,
	EMPLOYEEADDRESS1,
	EMPLOYEEADDRESS2,
	EMPLOYEECITY,
	EMPLOYEESTATE,
	EMPLOYEEZIP
) target_lag = '1 day' refresh_mode = INCREMENTAL initialize = ON_CREATE warehouse = COMPUTE_WH
 as
select 
	e.EmployeeXRefCode
	,e.EmployeeNumber
	,e.ManagerEmployeeNumber
	,e.FirstName
	,e.LastName
	,e.MiddleName
	,e.CommonName
	,e.BusinessEmail
	,e.EmploymentStatus
	,e.EmploymentStatusGroup
	,e.OriginalHireDate
	,e.HireDate
	,e.EstimatedReturnDate
	,e.TerminationDate
	,e.EmployeeGroupXRefCode
	,e.EmployeeGroup
	,e.DepartmentXRefCode
	,e.Department
	,e.LedgerCode
	,e.PrimaryLocationXRefCode
	,e.PrimaryLocation
	,e.JobXrefCode
	,e.JobName
	,e.JobFamilyXRefCode
	,e.JobFamily
	,e.PayClassXRefCode
	,e.PayClass
	,e.PayGroupXRefCode
	,e.PayGroup
	,e.PayTypeXRefCode
	,e.PayType
	,e.PayTypeGroupXRefCode
	,e.PayTypeGroup
	,e.NormalWeeklyHours
	,e.BaseCreatedDate
	,e.BaseUpdatedDate
	,e.BaseDeletedFlag
	,e.EmploymentStatusLastModifiedDate
	,e.FederatedId
	,e.EmploymentStatusEffectiveStart
	,e.HomePhone
	,e.DepartmentLedgerCode
	,e.PositionName
	,e.MobilePhone
	,e.DepartmentID
	,e.LocationID
	,e.EmployeeAddress1
	,e.EmployeeAddress2
	,e.EmployeeCity
	,e.EmployeeState
	,e.EmployeeZip
FROM {{ environment }}_REPORTING_DB.TABLEAU.EMPLOYEES e
;